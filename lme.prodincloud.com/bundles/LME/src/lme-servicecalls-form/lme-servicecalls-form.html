<html><head></head><body><div hidden="" by-polymer-bundler=""><script>!function(e){var t={};function i(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function l(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}t.mk_block=function(e,t,n){1===arguments.length&&(t="\n\n");var r=new String(e);return r.trailing=t,r.inspect=l,r.toSource=i,void 0!==n&&(r.lineNumber=n),r};var s=t.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};Array.prototype.forEach?t.forEach=function(e,t,n){return e.forEach(t,n)}:t.forEach=function(e,t,n){for(var r=0;r<e.length;r++)t.call(n||e,e[r],r,e)},t.isEmpty=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0},t.extract_attr=function(e){return s(e)&&1<e.length&&"object"==typeof e[1]&&!s(e[1])?e[1]:void 0};var n=function(e){switch(typeof e){case"undefined":this.dialect=n.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in n.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=n.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};n.dialects={};var p=n.mk_block=t.mk_block;s=t.isArray;function a(e){return e.split("\n").length-1}n.parse=function(e,t){return new n(t).toTree(e)},n.prototype.split_blocks=function(e){e=e.replace(/\r\n?/g,"\n");var t,n=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],i=1;for(null!==(t=/^(\s*\n)/.exec(e))&&(i+=a(t[0]),n.lastIndex=t[0].length);null!==(t=n.exec(e));)"\n#"===t[2]&&(t[2]="\n",n.lastIndex--),r.push(p(t[1],t[2],i)),i+=a(t[0]);return r},n.prototype.processBlock=function(e,t){var n=this.dialect.block,r=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var i=0;i<r.length;i++){var l=n[r[i]].call(this,e,t);if(l)return(!s(l)||0<l.length&&!s(l[0])&&"string"!=typeof l[0])&&this.debug(r[i],"didn't return proper JsonML"),l}return[]},n.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},n.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),r=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var i=this.processBlock(n.shift(),n);i.length&&this.tree.push.apply(this.tree,i)}return this.tree}finally{t&&(this.tree=r)}},n.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,e)},n.prototype.loop_re_over_block=function(e,t,n){for(var r,i=t.valueOf();i.length&&null!==(r=e.exec(i));)i=i.substr(r[0].length),n.call(this,r);return i},n.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!==n&&"__call__"!==n&&t.push(n);e.__order__=t},n.buildInlinePatterns=function(e){var n=[];for(var t in e)if(!t.match(/^__.*__$/)){var r=t.replace(/([\\.*+?^$|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");n.push(1===t.length?r:"(?:"+r+")")}n=n.join("|"),e.__patterns__=n;var i=e.__call__;e.__call__=function(e,t){return void 0!==t?i.call(this,e,t):i.call(this,e,n)}};var g=t.extract_attr;function c(e){return e&&0<e.length?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}function o(e){if("string"==typeof e)return c(e);var t=e.shift(),n={},r=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)r.push(o(e.shift()));var i="";for(var l in void 0!==n.src&&(i+=' src="'+c(n.src)+'"',delete n.src),n){var s=c(n[l]);s&&s.length&&(i+=" "+l+'="'+s+'"')}return"img"===t||"br"===t||"hr"===t?"<"+t+i+"/>":"<"+t+i+">"+r.join("")+"</"+t+">"}n.renderJsonML=function(e,t){(t=t||{}).root=t.root||!1;var n=[];if(t.root)n.push(o(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(o(e.shift()));return n.join("\n\n")},n.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var r=g(e),i={};r&&r.references&&(i=r.references);var l=function e(t,n,r){var i;r=r||{};var l=t.slice(0);"function"==typeof r.preprocessTreeNode&&(l=r.preprocessTreeNode(l,n));var s=g(l);if(s){for(i in l[1]={},s)l[1][i]=s[i];s=l[1]}if("string"==typeof l)return l;switch(l[0]){case"header":l[0]="h"+l[1].level,delete l[1].level;break;case"bulletlist":l[0]="ul";break;case"numberlist":l[0]="ol";break;case"listitem":l[0]="li";break;case"para":l[0]="p";break;case"markdown":l[0]="html",s&&delete s.references;break;case"code_block":l[0]="pre",i=s?2:1;var a=["code"];a.push.apply(a,l.splice(i,l.length-i)),l[i]=a;break;case"inlinecode":l[0]="code";break;case"img":l[1].src=l[1].href,delete l[1].href;break;case"linebreak":l[0]="br";break;case"link":l[0]="a";break;case"link_ref":l[0]="a";var c=n[s.ref];if(!c)return s.original;delete s.ref,s.href=c.href,c.title&&(s.title=c.title),delete s.original;break;case"img_ref":l[0]="img";var c=n[s.ref];if(!c)return s.original;delete s.ref,s.src=c.href,c.title&&(s.title=c.title),delete s.original}i=1;if(s){for(var o in l[1]){i=2;break}1===i&&l.splice(i,1)}for(;i<l.length;++i)l[i]=e(l[i],n,r);return l}(e,i,n);return function e(t){var n=g(t)?2:1;for(;n<t.length;)"string"==typeof t[n]?n+1<t.length&&"string"==typeof t[n+1]?t[n]+=t.splice(n+1,1)[0]:++n:(e(t[n]),++n)}(l),l},n.toHTML=function(e,t,n){var r=this.toHTMLTree(e,t,n);return this.renderJsonML(r)};var x,M,S,E,r={inline_until_char:function(e,t){for(var n=0,r=[];;){if(e.charAt(n)===t)return[++n,r];if(n>=e.length)return[n,null,r];var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0],r.push.apply(r,i.slice(1))}},subclassDialect:function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}}},A=t.forEach,v=(g=t.extract_attr,p=t.mk_block,t.isEmpty),d=r.inline_until_char,_=/(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?/i.source,h={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var r=["header",{level:n[1].length}];return Array.prototype.push.apply(r,this.processInline(n[2])),n[0].length<e.length&&t.unshift(p(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]}},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var r=["header",{level:"="===n[2]?1:2}].concat(this.processInline(n[1]));return n[0].length<e.length&&t.unshift(p(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]}},code:function(e,t){var n=[],r=/^(?: {0,3}\t| {4})(.*)\n?/;if(e.match(r)){e:for(;;){var i=this.loop_re_over_block(r,e.valueOf(),function(e){n.push(e[1])});if(i.length){t.unshift(p(i,e.trailing));break e}if(!t.length)break e;if(!t[0].match(r))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var r=[["hr"]];if(n[1]){var i=p(n[1],"",e.lineNumber);r.unshift.apply(r,this.toTree(i,[]))}return n[3]&&t.unshift(p(n[3],e.trailing,e.lineNumber+1)),r}},lists:(x="[*+-]|\\d+\\.",M=/[*+-]/,S=new RegExp("^( {0,3})("+x+")[ \t]+"),E="(?: {0,3}\\t| {4})",function(e,t){var n=e.match(S);if(n){for(var r,i,l,s=[],a=$(n),c=!1,o=[s[0].list];;){for(var h=e.split(/(?=\n)/),f="",u="",p=0;p<h.length;p++){u="";var g=h[p].replace(/^\n/,function(e){return u=e,""}),v=(l=s.length,new RegExp("(?:^("+E+"{0,"+l+"} {0,3})("+x+")\\s+)|(^"+E+"{0,"+(l-1)+"}[ ]{0,4})"));if(void 0!==(n=g.match(v))[1]){f.length&&(T(r,c,this.processInline(f),u),c=!1,f=""),n[1]=n[1].replace(/ {0,3}\t/g,"    ");var d=Math.floor(n[1].length/4)+1;if(d>s.length)a=$(n),r.push(a),r=a[1]=["listitem"];else{var _=!1;for(i=0;i<s.length;i++)if(s[i].indent===n[1]){a=s[i].list,s.splice(i+1,s.length-(i+1)),_=!0;break}_||(++d<=s.length?(s.splice(d,s.length-d),a=s[d-1].list):(a=$(n),r.push(a))),r=["listitem"],a.push(r)}u=""}g.length>n[0].length&&(f+=u+g.substr(n[0].length))}if(f.length){var b=this.processBlock(f,[]),m=b[0];m&&(m.shift(),b.splice.apply(b,[0,1].concat(m)),T(r,c,b,u),"\n"===r[r.length-1]&&r.pop(),c=!1,f="")}var k=L(s.length,t);0<k.length&&(A(s,I,this),r.push.apply(r,this.toTree(k,[])));var y=t[0]&&t[0].valueOf()||"";if(!y.match(S)&&!y.match(/^ /))break;e=t.shift();var w=this.dialect.block.horizRule.call(this,e,t);if(w){o.push.apply(o,w);break}s[s.length-1].indent===e.match(/^\s*/)[0]&&A(s,I,this),c=!0}return o}function $(e){var t=M.exec(e[2])?["bulletlist"]:["numberlist"];return s.push({list:t,indent:e[1]}),t}}),blockquote:function(e,t){var n=/(^|\n) +(\>[\s\S]*)/.exec(e);if(n&&n[2]&&n[2].length){var r=e.replace(/(^|\n) +\>/,"$1>");return t.unshift(r),[]}if(e.match(/^>/m)){var i=[];if(">"!==e[0]){for(var l=e.split(/\n/),s=[],a=e.lineNumber;l.length&&">"!==l[0][0];)s.push(l.shift()),a++;var c=p(s.join("\n"),"\n",e.lineNumber);i.push.apply(i,this.processBlock(c,[])),e=p(l.join("\n"),e.trailing,a)}for(;t.length&&">"===t[0][0];){var o=t.shift();e=p(e+e.trailing+o,o.trailing,e.lineNumber)}var h=e.replace(/^> ?/gm,""),f=(this.tree,this.toTree(h,["blockquote"])),u=g(f);return u&&u.references&&(delete u.references,v(u)&&f.splice(1,1)),i.push(f),i}},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*)\3|\((.*?)\)))?\n?/;if(e.match(n)){var r=b.call(this),i=this.loop_re_over_block(n,e,function(e){m(r,e)});return i.length&&t.unshift(p(i,e.trailing)),[]}},para:function(e){return[["para"].concat(this.processInline(e))]}},inline:{__oneElement__:function(e,t,n){var r,i;return t=t||this.dialect.inline.__patterns__,(r=new RegExp("([\\s\\S]*?)("+(t.source||t)+")").exec(e))?r[1]?[r[1].length,r[1]]:(r[2]in this.dialect.inline&&(i=this.dialect.inline[r[2]].call(this,e.substr(r.index),r,n||[])),i=i||[r[2].length,r[2]]):[e.length,e]},__call__:function(e,t){var n,r=[];function i(e){"string"==typeof e&&"string"==typeof r[r.length-1]?r[r.length-1]+=e:r.push(e)}for(;0<e.length;)n=this.dialect.inline.__oneElement__.call(this,e,t,r),e=e.substr(n.shift()),A(n,i);return r},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}<>\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){if(!(0<=e.indexOf("(")&&-1===e.indexOf(")"))){var t=e.match(new RegExp("^!\\[(.*?)][ \\t]*\\(("+_+")\\)([ \\t])*([\"'].*[\"'])?"))||e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"===t[2][0]&&">"===t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return(t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/))?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]}},"[":function(e){for(var t=1,n=0;n<e.length;n++){var r=e.charAt(n);if("["===r&&t++,"]"===r&&t--,3<t)return[1,"["]}var i=String(e),l=d.call(this,e.substr(1),"]");if(!l[1])return[l[0]+1,e.charAt(0)].concat(l[2]);var s,a,c=1+l[0],o=l[1],h=(e=e.substr(c)).match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(h){var f=h[1].replace(/\s+$/,"");if(c+=h[0].length,f&&"<"===f[0]&&">"===f[f.length-1]&&(f=f.substring(1,f.length-1)),!h[3])for(var u=1,p=0;p<f.length;p++)switch(f[p]){case"(":u++;break;case")":0==--u&&(c-=f.length-p,f=f.substring(0,p))}return a={href:(f=this.dialect.inline.__call__.call(this,f,/\\/)[0])||""},void 0!==h[3]&&(a.title=h[3]),s=["link",a].concat(o),[c,s]}return(h=e.match(new RegExp("^\\(("+_+")\\)")))&&h[1]?(c+=h[0].length,s=["link",{href:h[1]}].concat(o),[c,s]):(h=e.match(/^\s*\[(.*?)\]/))&&(c+=h[0].length,a={ref:(h[1]||String(o)).toLowerCase(),original:i.substr(0,c)},o&&0<o.length)?(s=["link_ref",a].concat(o),[c,s]):(h=i.match(/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/))?(m(a=b.call(this),h),[h[0].length]):1!==o.length||"string"!=typeof o[0]?[1,"["]:(s=["link_ref",a={ref:o[0].toLowerCase().replace(/\s+/," "),original:i.substr(0,c)},o[0]],[c,s])},"<":function(e){var t;return null!==(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"===t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}}};function T(e,t,n,r){if(t)e.push(["para"].concat(n));else{var i=e[e.length-1]instanceof Array&&"para"===e[e.length-1][0]?e[e.length-1]:e;r&&1<e.length&&n.unshift(r);for(var l=0;l<n.length;l++){var s=n[l];"string"==typeof s&&1<i.length&&"string"==typeof i[i.length-1]?i[i.length-1]+=s:i.push(s)}}}function L(e,t){for(var n=new RegExp("^("+E+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+E+"{"+e+"}","gm"),i=[];0<t.length&&n.exec(t[0]);){var l=t.shift(),s=l.replace(r,"");i.push(p(s,l.trailing,l.lineNumber))}return i}function I(e,t,n){var r=e.list,i=r[r.length-1];if(!(i[1]instanceof Array&&"para"===i[1][0]))if(t+1===n.length)i.push(["para"].concat(i.splice(1,i.length-1)));else{var l=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),l)}}function f(l,s){var a=l+"_state",c="strong"===l?"em_state":"strong_state";function o(e){this.len_after=e,this.name="close_"+s}return function(e){if(this[a][0]===s)return this[a].shift(),[e.length,new o(e.length-s.length)];var t=this[c].slice(),n=this[a].slice();this[a].unshift(s);var r=this.processInline(e.substr(s.length)),i=r[r.length-1];this[a].shift();return i instanceof o?(r.pop(),[e.length-i.len_after,[l].concat(r)]):(this[c]=t,this[a]=n,[s.length,s])}}function b(){g(this.tree)||this.tree.splice(1,0,{});var e=g(this.tree);return void 0===e.references&&(e.references={}),e}function m(e,t){t[2]&&"<"===t[2][0]&&">"===t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1));var n=e.references[t[1].toLowerCase()]={href:t[2]};void 0!==t[4]?n.title=t[4]:void 0!==t[5]&&(n.title=t[5])}h.inline["**"]=f("strong","**"),h.inline.__=f("strong","__"),h.inline["*"]=f("em","*"),h.inline._=f("em","_"),n.dialects.Gruber=h,n.buildBlockOrder(n.dialects.Gruber.block),n.buildInlinePatterns(n.dialects.Gruber.inline);var u=r.subclassDialect(h);g=t.extract_attr,A=t.forEach;u.processMetaHash=function(e){for(var t=function(e){var t=e.split(""),n=[""],r=!1;for(;t.length;){var i=t.shift();switch(i){case" ":r?n[n.length-1]+=i:n.push("");break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i}}return n}(e),n={},r=0;r<t.length;++r)if(/^#/.test(t[r]))n.id=t[r].substring(1);else if(/^\./.test(t[r]))n.class?n.class=n.class+t[r].replace(/./," "):n.class=t[r].substring(1);else if(/\=/.test(t[r])){var i=t[r].split(/\=/);n[i[0]]=i[1]}return n},u.block.document_meta=function(e){if(!(1<e.lineNumber)&&e.match(/^(?:\w+:.*\n)*\w+:.*$/)){g(this.tree)||this.tree.splice(1,0,{});var t=e.split(/\n/);for(var n in t){var r=t[n].match(/(\w+):\s*(.*)$/),i=r[1].toLowerCase(),l=r[2];this.tree[1][i]=l}return[]}},u.block.block_meta=function(e){var t=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(t){var n,r=this.dialect.processMetaHash(t[2]);if(""===t[1]){var i=this.tree[this.tree.length-1];if(n=g(i),"string"==typeof i)return;for(var l in n||(n={},i.splice(1,0,n)),r)n[l]=r[l];return[]}var s=e.replace(/\n.*$/,""),a=this.processBlock(s,[]);for(var l in(n=g(a[0]))||(n={},a[0].splice(1,0,n)),r)n[l]=r[l];return a}},u.block.definition_list=function(e,t){var n,r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,i=["dl"];if(a=e.match(r)){for(var l=[e];t.length&&r.exec(t[0]);)l.push(t.shift());for(var s=0;s<l.length;++s){var a,c=(a=l[s].match(r))[1].replace(/\n$/,"").split(/\n/),o=a[2].split(/\n:\s+/);for(n=0;n<c.length;++n)i.push(["dt",c[n]]);for(n=0;n<o.length;++n)i.push(["dd"].concat(this.processInline(o[n].replace(/(\n)\s+/,"$1"))))}return[i]}},u.block.table=function(e){function n(e,t){(t=t||"\\s").match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,r=[],i=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(i);)r.push(n[1]),e=n[2];return r.push(e),r}var r,t;if(t=e.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))t[3]=t[3].replace(/^\s*\|/gm,"");else if(!(t=e.match(/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/)))return;var i=["table",["thead",["tr"]],["tbody"]];t[2]=t[2].replace(/\|\s*$/,"").split("|");var l=[];for(A(t[2],function(e){e.match(/^\s*-+:\s*$/)?l.push({align:"right"}):e.match(/^\s*:-+\s*$/)?l.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?l.push({align:"center"}):l.push({})}),t[1]=n(t[1].replace(/\|\s*$/,""),"|"),r=0;r<t[1].length;r++)i[1][1].push(["th",l[r]||{}].concat(this.processInline(t[1][r].trim())));return A(t[3].replace(/\|\s*$/gm,"").split("\n"),function(e){var t=["tr"];for(e=n(e,"|"),r=0;r<e.length;r++)t.push(["td",l[r]||{}].concat(this.processInline(e[r].trim())));i[2].push(t)},this),[i]},u.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var r=n[n.length-1];if("string"==typeof r)return[2,"{:"];var i=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!i)return[2,"{:"];var l=this.dialect.processMetaHash(i[1]),s=g(r);for(var a in s||(s={},r.splice(1,0,s)),l)s[a]=l[a];return[i[0].length,""]},n.dialects.Maruku=u,n.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,n.buildBlockOrder(n.dialects.Maruku.block),n.buildInlinePatterns(n.dialects.Maruku.inline),e.Markdown=n,e.parse=n.parse,e.toHTML=n.toHTML,e.toHTMLTree=n.toHTMLTree,e.renderJsonML=n.renderJsonML,e.DialectHelpers=r}((window.markdown={},window.markdown));</script><script>!function(e){"use strict";e.CP=e.CP||{},e.CP.NotesCommonBehavior={properties:{markdown:{type:Boolean,value:!1},avatar:{type:Boolean,value:!1}},markdownToHTML:function(e){return this.preserverNewLines(markdown.toHTML(e))},preserverNewLines:function(e){return e.replace(/(?:\r\n|\r|\n)/g,"<br style='display: block; margin-top: 0; content:\"\" '/>")}}}(window.App=window.App||{});</script><dom-module id="cp-note" assetpath="../../../../src/cp-notes/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;width:100%}paper-dialog{min-width:25%;max-width:50%;border-top:4px solid #0b4395}.card{white-space:normal;padding:12px;margin-bottom:16px;transition:border 360ms}.card:focus{outline:0}.card .avatar{margin-right:20px}.card .avatar bbx-avatar{--fop-avatar-width:24px;--fop-avatar-height:24px}.card .creator{font-weight:700}.card .date{color:#9e9191}.card paper-textarea{min-width:100%;--paper-input-container-underline:{display:none};--paper-input-container-underline-focus:{display:none};--paper-input-container-underline-disabled:{display:none};}.controlsNoEditMode{visibility:hidden;opacity:0;transition:opacity 360ms}.card:focus .controlsNoEditMode,.card:hover .controlsNoEditMode{opacity:1;visibility:visible}</style><paper-dialog id="dialog" entry-animation="scale-up-animation" exit-animation="scale-down-animation"><h2><iron-icon icon="icons:delete"></iron-icon>[[__('cp-notes.dialog-title')]]</h2><paper-dialog-scrollable><p>[[note.TEXT]]</p></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[__('cp-notes.dialog-cancel')]]</paper-button><paper-button dialog-confirm="" autofocus="" on-tap="_onDeleteConfirm">[[__('cp-notes.dialog-confirm')]]</paper-button></div></paper-dialog><div class="card layout horizontal" edit-mode="[[editMode]]"><template is="dom-if" if="[[avatar]]" restamp="true"><div class="avatar"><bbx-avatar app-name="[[config.firebase.projectId]]" key="[[_getAvatarKey(note.CREABYID)]]" src$="[[rootPath]]assets/images/nn.png"></bbx-avatar></div></template><div class="flex"><div class="layout horizontal center header"><div class="flex"><div class="creator">[[note.CREABYDESC]]</div><div class="date">[[formatDate(note.CREADD,language,'dateFormat')]]</div></div><div><template is="dom-if" if="[[editMode]]" restamp="true"><div class="controlsEditMode"><paper-icon-button icon="icons:save" on-tap="_onUpdateListener"></paper-icon-button><paper-icon-button icon="icons:undo" on-tap="_toggleEditMode"></paper-icon-button></div></template><template is="dom-if" if="[[!editMode]]" restamp="true"><template is="dom-if" if="[[editable]]" restamp="true"><div class="controlsNoEditMode"><paper-icon-button icon="editor:mode-comment" on-tap="_toggleEditMode"></paper-icon-button><paper-icon-button icon="icons:delete" on-tap="_onDeleteListener"></paper-icon-button></div></template></template></div></div><div class="content"><template is="dom-if" if="[[!editMode]]" restamp=""><template is="dom-if" if="[[markdown]]"><p class="text" inner-h-t-m-l="{{markdownToHTML(note.TEXT)}}"></p></template><template is="dom-if" if="[[!markdown]]" restamp=""><p class="text">[[note.TEXT]]</p></template></template><template is="dom-if" if="[[editMode]]" restamp=""><paper-textarea id="textarea" autofocus="" value="{{editText}}" rows="1"></paper-textarea></template></div></div></div></template><script>Polymer({is:"cp-note",behaviors:[App.LocalizeBehavior,App.ConfigBehavior,App.CP.NotesCommonBehavior],properties:{note:Object,editText:String,editMode:{type:Boolean,value:!1},editable:{type:Boolean,value:!1}},_getNoteClone:function(){var e=JSON.parse(JSON.stringify(this.note));return e.TEXT=this.editText?this.editText:e.TEXT,e},_getAvatarKey:function(e){return this.config.namespace+"/"+e},_toggleEditMode:function(){this.editable&&(this.set("editText",this.note.TEXT),this.set("editMode",!this.editMode),this.fire("note-editmode"),this.async(function(){var e=Polymer.dom(this.root).querySelector("#textarea");e&&e.focus()}.bind(this),100))},_onUpdateListener:function(){var e=this._getNoteClone();this.set("note",e),this.fire("note-update",{note:e,el:this}),this._toggleEditMode()},_onDeleteListener:function(){this.$.dialog.open()},_onDeleteConfirm:function(e){this.fire("note-delete",{note:this._getNoteClone(),el:this}),this.hidden=!0}});</script></dom-module><dom-module id="cp-notes" assetpath="../../../../src/cp-notes/"><template><style include="iron-flex iron-flex-alignment">:host{display:block}.new-input{padding-right:12px;padding-left:12px;border:thin solid #f1f1f1;margin-bottom:20px}.new-input paper-input-container{margin:0 20px;--paper-input-container-underline:{display:none};--paper-input-container-underline-focus:{display:none};--paper-input-container-underline-disabled:{display:none};}.new-input paper-icon-button{background:var(--app-primary-color);border-radius:50%;color:#fff!important;--iron-icon:{color:#fff!important;fill:#fff!important;margin-left:2px};}</style><app-request-error><iron-ajax id="notesReq" url="[[notesUrl]]" handle-as="json" last-response="{{notes}}" loading="{{loadingList}}" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax><iron-ajax id="noteReq" handle-as="json" content-type="application/json" loading="{{loadingUpdate}}" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax></app-request-error><div class="new-input layout horizontal center"><div class="flex"><div class="layout horizontal center"><iron-icon icon="communication:comment"></iron-icon>&nbsp;<paper-input-container always-float-label="" class="flex"><textarea placeholder="[[__('cp-notes.leaveComment')]]" value="{{newNote::input}}" rows="2" max-rows="4"></textarea></paper-input-container></div></div><paper-icon-button on-tap="_onNewListener" icon="icons:send"></paper-icon-button></div><div class="list"><template id="list" is="dom-repeat" items="[[notes]]" as="note" restamp=""><cp-note id="[[note.NOTEID]]" class="card" tabindex$="[[index]]" note="[[note]]" markdown="[[markdown]]" avatar="[[avatar]]" editable="[[_isOwner(note)]]" language="{{language}}" languages="{{languages}}"></cp-note></template></div></template><script>Polymer({is:"cp-notes",behaviors:[App.LocalizeBehavior,App.ConfigBehavior,App.CP.NotesCommonBehavior],properties:{entity:String,entityId:String,notes:Array,notesUrl:String,newNote:String,loadingList:{type:Boolean,value:!1,notify:!0},loadingUpdate:{type:Boolean,value:!1,notify:!0},count:{type:Number,value:0,notify:!0}},observers:["_entityChanged(entity,entityId)"],listeners:{"note-update":"_onUpdateListener","note-delete":"_onDeleteListener","note-editmode":"_onEditModeListener","notesReq.response":"_onResponseListener"},_isOwner:function(e){return App.Auth.getCurrentUser().USERID===e.CREABYID},_getNotesUrl:function(e,t,n){var i=this.config.api.base+BBX.URL.buildRestPath(this.config.api.endpoints.Notes,{entity:e,id:t,note:n});return n||(i=i.slice(0,-1)),t||(i=i.slice(0,-1)),i},_entityChanged:function(e,t){e&&t&&(this.set("notesUrl",this._getNotesUrl(e,t,"")),this.$.notesReq.generateRequest())},_generateNoteReq:function(e,t,n){var i=this.$.noteReq,s=this._getNotesUrl(this.entity,this.entityId,e);return i.set("method",t),i.set("url",s),n&&i.set("body",n),i.generateRequest()},_onResponseListener:function(e){e.detail.response.length?(this.set("notes",e.detail.response.reverse()),this.set("count",e.detail.response.length)):this.set("count",0)},_onNewListener:function(e){this.newNote&&!this.newNote.lenght&&(13!==e.keyCode&&"tap"!=e.type||this._generateNoteReq("","POST",{TEXT:this.newNote}).completes.then(function(e){this.unshift("notes",e.response[0]),this.set("newNote",""),this.set("count",++this.count),this.updateStyles()}.bind(this)))},_onUpdateListener:function(e){var t=e.detail.note;this._generateNoteReq(t.NOTEID,"POST",{TEXT:t.TEXT})},_onDeleteListener:function(e){var t=e.detail.note;this._generateNoteReq(t.NOTEID,"DELETE",{TEXT:t.TEXT}).completes.then(function(){this.set("count",--this.count)}.bind(this))},_onEditModeListener:function(){this.$.list.render()}});</script></dom-module><link rel="import" href="../../../../src/app-theme/app-theme.html"></div><dom-module id="lme-servicecalls-form"><template><style include="app-theme lme-shared-style iron-flex iron-flex-alignment"></style><iron-location query="{{query}}"></iron-location><iron-query-params params-string="{{query}}" params-object="{{queryParams}}"></iron-query-params><app-request-error><app-resturl url="{{entityUrl}}" endpoint="ServiceCalls" rest-object="[[entityReqRestObject]]"></app-resturl><iron-ajax id="entityReq" url="[[entityUrl]]" handle-as="json" last-response="{{entityReqResult}}" loading="{{loadingForm}}" content-type="application/json" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax><app-resturl url="{{prioritesUrl}}" endpoint="ServiceCallsLookup" rest-object="[[prioritesReqRestObject]]" query-object="[[lookupReqParams]]"></app-resturl><iron-ajax id="prioritesReq" url="[[prioritesUrl]]" handle-as="json" last-response="{{prioritesReqResult}}" loading="{{loadingForm}}" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax><app-resturl url="{{contactsUrl}}" endpoint="ServiceCallsLookup" rest-object="[[contactsReqRestObject]]" query-object="[[lookupReqParams]]"></app-resturl><iron-ajax id="contactsReq" url="[[contactsUrl]]" handle-as="json" last-response="{{contactsReqResult}}" loading="{{loadingForm}}" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax><app-resturl url="{{objsUrl}}" endpoint="ServiceCallsLookup" rest-object="[[objsReqRestObject]]" query-object="[[lookupReqParams]]"></app-resturl><iron-ajax id="objsReq" url="[[objsUrl]]" handle-as="json" last-response="{{objsReqResult}}" loading="{{loadingForm}}" debounce-duration="[[config.api.debounce]]" bubbles=""></iron-ajax></app-request-error><div class="collapse-container"><paper-collapse-group class="full"><paper-collapse-item id="details-collapse" icon="icons:description" header="{{__('lme-servicecalls-form.details')}}" opened=""><div id="form" class="content"><spinner-backdrop loading="[[loadingForm]]"></spinner-backdrop><div class="layout horizontal wrap" hidden="[[!params.ISUPDATE]]"><paper-input class="flex" label="{{__('lme-servicecalls-form.id')}}" value="{{entity.CALLID}}" readonly="" always-float-label=""></paper-input><paper-input class="flex" label="{{__('lme-servicecalls-form.status')}}" value="{{entity.STATUSDESC}}" readonly="" always-float-label=""></paper-input></div><paper-input label="{{__('lme-servicecalls-form.location')}}" value="{{entity.INSTALLADDRDESC}}" readonly="" hidden="[[!params.ISUPDATE]]" always-float-label=""></paper-input><paper-input class="" label="{{__('lme-servicecalls-form.desc')}}" value="{{entity.DESC}}" disabled="[[loadingForm]]" maxlength="100" always-float-label=""></paper-input><div class="layout horizontal wrap"><vaadin-combo-box class="flex" id="priority" label="{{__('lme-servicecalls-form.priority')}}" item-label-path="DESC" item-value-path="CALLPRIORITYID" items="[[prioritesReqResult]]" value="{{entity.CALLPRIORITYID}}" disabled="[[loadingForm]]" loading="[[loadingForm]]" always-float-label="" prevent-invalid-input=""></vaadin-combo-box><vaadin-combo-box class="flex" id="contact" label="{{__('lme-servicecalls-form.contact')}}" item-label-path="DESC" item-value-path="CONTACTID" items="[[contactsReqResult]]" value="{{entity.CONTACTID}}" disabled="[[loadingForm]]" loading="[[loadingForm]]" always-float-label="" prevent-invalid-input=""></vaadin-combo-box><vaadin-combo-box class="flex" id="obj" label="{{__('lme-servicecalls-form.object')}}" item-label-path="DESC" item-value-path="SERVICEOBJECTID" items="[[objsReqResult]]" value="{{entity.SERVICEOBJECTID}}" disabled="[[loadingForm]]" loading="[[loadingForm]]" always-float-label="" prevent-invalid-input=""><template>[[item.SERVICEOBJECTID]] - [[item.DESC]]</template></vaadin-combo-box></div><div class="layout horizontal wrap end-justified"><paper-button class="button" data-operation="update" disabled="[[_isButtonDisabled(changed,loadingForm,invalid)]]" on-tap="_onUpdateCreateListener" hidden="[[!params.ISUPDATE]]" raised="">{{__('lme-servicecalls-form.update')}}</paper-button><paper-button class="button" data-operation="create" disabled="[[_isButtonDisabled(changed,loadingForm,invalid)]]" on-tap="_onUpdateCreateListener" hidden="[[params.ISUPDATE]]" raised="">{{__('lme-servicecalls-form.create')}}</paper-button></div></div></paper-collapse-item><paper-collapse-item hidden="[[!params.ISUPDATE]]" icon="icons:attachment" header="{{__('lme-servicecalls-form.attachments')}}"><div class="content"><spinner-backdrop loading="[[loadingArchives]]"></spinner-backdrop><cp-archives entity="ServiceCalls" entity-id="[[params.id]]" language="{{language}}" languages="{{languages}}" loading-list="{{loadingArchives}}" count="{{archivesCount}}"></cp-archives></div><div slot="buttons"><div class="badge">[[archivesCount]]</div></div></paper-collapse-item><paper-collapse-item hidden="[[!params.ISUPDATE]]" icon="icons:speaker-notes" header="{{__('lme-servicecalls-form.notes')}}"><div class="content"><spinner-backdrop loading="[[loadingNotes]]"></spinner-backdrop><cp-notes entity="ServiceCalls" entity-id="[[params.id]]" avatar="" markdown="[[config.enableMakrdown]]" language="{{language}}" languages="{{languages}}" loading-list="{{loadingNotes}}" count="{{notesCount}}"></cp-notes></div><div slot="buttons"><div class="badge">[[notesCount]]</div></div></paper-collapse-item></paper-collapse-group></div></template><script>Polymer({is:"lme-servicecalls-form",behaviors:[App.CP.ComponentBehavior],properties:{query:String,queryParams:Object,entity:Object,entityReqRestObject:Object,entityUrl:String,entityReqResult:Array,prioritesReqRestObject:Object,prioritesUrl:String,prioritesReqResult:Array,contactsReqRestObject:Object,contactsUrl:String,contactsReqResult:Array,objsReqRestObject:Object,objsUrl:String,objsReqResult:Array,notesCount:Number,archivesCount:Number,loading:{type:Boolean,value:{form:!1,archives:!1,notes:!1}},loadingForm:{type:Boolean,value:!1,notify:!0},loadingArchives:{type:Boolean,value:!1,notify:!0},loadingNotes:{type:Boolean,value:!1,notify:!0},invalid:{type:Boolean,value:!1,notify:!0},changed:{type:Boolean,value:!1},lookupReqParams:Object},observers:["_paramsChanged(params,params.*)","_queryParamsChanged(queryParams._bc,queryParams._id)"],listeners:{"entityReq.response":"_onEntityResponseListener","form.value-changed":"_validate","form.selected-item-changed":"_validate","form.change":"_validate"},_validate:function(e){var t=Polymer.dom(this.root).querySelectorAll(".auto-validate");this.changed=!0;try{for(var s in t)if("function"==typeof t[s].validate&&0==t[s].validate())return this.set("invalid",!0),!0;return this.set("invalid",!1),!1}catch(e){return!1}},_queryParamsChanged:function(t,s){if("ServiceCalls"===t){var e=this.$$("#details-collapse");e&&(e.opened=!0),this.debounce("lme-servicecalls-form#_qureyParamsChanged",function(){var e={id:s,bc:t,customerId:this.queryParams["[[CUSTOMERID]]"],loginCustomerIds:this.queryParams["[[LOGINCUSTOMERIDS]]"],ISUPDATE:""!=s};e[[this.config.api.BCIDValueMapping.ServiceCalls]]=s,this.set("params",e)}.bind(this),this.config.api.debounce)}},_paramsChanged:function(e){e&&Object.keys(e).length&&this.debounce("lme-servicecalls-form#_paramsChanged",function(){this.set("entityReqRestObject",{id:e.CALLID}),this.set("prioritesReqRestObject",{entity:"CALLPRIORITYID"}),this.set("contactsReqRestObject",{entity:"CONTACTID"}),this.set("objsReqRestObject",{entity:"SERVICEOBJECTID"}),e.ISUPDATE?this.$.entityReq.generateRequest().completes.then(function(e){if(e.response){var t=e.response[0];this.set("lookupReqParams",{INSTALLADDRID:t.INSTALLADDRID}),Promise.all([this.$.prioritesReq.generateRequest(),this.$.contactsReq.generateRequest(),this.$.objsReq.generateRequest()]).then(function(){this.$.contact.set("value",t.CONTACTID),this.$.obj.set("value",t.SERVICEOBJECTID)}.bind(this))}}.bind(this)):(this.set("lookupReqParams",{INSTALLADDRID:e.customerId}),this.entity={},this.$.prioritesReq.generateRequest(),this.$.contactsReq.generateRequest(),this.$.objsReq.generateRequest())}.bind(this),this.config.api.debounce)},_onEntityResponseListener:function(e){if(!e.detail.response)return!1;var t=this.config.api.BCIDValueMapping.ServiceCalls;this.set("entity",_.pick(e.detail.response[0],[t,"STATUSDESC","INSTALLADDRDESC","DESC","CONTACTID","CALLPRIORITYID","SERVICEOBJECTID"]))},_onUpdateCreateListener:function(t){var s=this.config.api.BCIDValueMapping.ServiceCalls,i=this.$.entityReq,e=_.omit(this.entity,[s,"STATUSDESC","INSTALLADDRDESC"]);e.REGISTEREDBYCONTACTID=e.CONTACTID,e.CUSTOMERID=this.params.customerId||i.lastResponse[0].customerId,e.INSTALLADDRID=this.params.customerId,i.set("method","POST"),i.set("body",e),i.generateRequest().completes.then(function(e){i.set("method","GET"),i.set("body",""),"create"==t.target.getAttribute("data-operation")&&this.set("queryParams._id",e.response[0][s]),this.publish("notify-grid-refresh")}.bind(this))},_isButtonDisabled:function(e,t,s){return!!t||(!e||s)}});</script></dom-module></body></html>